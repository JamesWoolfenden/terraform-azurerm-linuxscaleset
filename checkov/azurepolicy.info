Microsoft.Compute
MICROSOFT.COMPUTE
Name
(Azure portal)    Description    Effect(s)    Version
(GitHub)
[ASC Private Preview] Deploy - Configure system-assigned managed identity to enable Azure Monitor assignments on VMs    [ASC Private Preview] Configure system-assigned managed identity to virtual machines hosted in Azure that are supported by Azure Monitor that do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Azure Monitor assignments and must be added to machines before using any Azure Monitor extension. Target virtual machines must be in a supported location.    modify    1.0.0-preview
[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted    Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    auditIfNotExists    1.0.0-preview
A vulnerability assessment solution should be enabled on your virtual machines    Audits virtual machines to detect whether they are running a supported vulnerability assessment solution. A core component of every cyber risk and security program is the identification and analysis of vulnerabilities. Azure Security Center's standard pricing tier includes vulnerability scanning for your virtual machines at no extra cost. Additionally, Security Center can automatically deploy this tool for you.    AuditIfNotExists, Disabled    3.0.0
Adaptive application controls for defining safe applications should be enabled on your machines    Enable application controls to define the list of known-safe applications running on your machines, and alert you when other applications run. This helps harden your machines against malware. To simplify the process of configuring and maintaining your rules, Security Center uses machine learning to analyze the applications running on each machine and suggest the list of known-safe applications.    AuditIfNotExists, Disabled    3.0.0
Adaptive network hardening recommendations should be applied on internet facing virtual machines    Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface    AuditIfNotExists, Disabled    3.0.0
Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities    This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration but do not have any managed identities. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.    modify    1.0.0
Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity    This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration and have at least one user-assigned identity but do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.    modify    1.0.0
All network ports should be restricted on network security groups associated to your virtual machine    Azure Security Center has identified some of your network security groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to target your resources.    AuditIfNotExists, Disabled    3.0.0
Allowed virtual machine size SKUs    This policy enables you to specify a set of virtual machine size SKUs that your organization can deploy.    Deny    1.0.1
Allowlist rules in your adaptive application control policy should be updated    Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center's adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to allow in adaptive application control policies.    AuditIfNotExists, Disabled    3.0.0
Audit Dependency agent deployment - VM Image (OS) unlisted    Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    auditIfNotExists    1.0.1
Audit Dependency agent deployment in virtual machine scale sets - VM Image (OS) unlisted    Reports virtual machine scale sets as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    auditIfNotExists    1.0.1
Audit Linux machines that allow remote connections from accounts without passwords    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that allow remote connections from accounts without passwords    AuditIfNotExists, Disabled    1.0.0
Audit Linux machines that do not have the passwd file permissions set to 0644    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that do not have the passwd file permissions set to 0644    AuditIfNotExists, Disabled    1.0.0
Audit Linux machines that don't have the specified applications installed    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Chef InSpec resource indicates that one or more of the packages provided by the parameter are not installed.    auditIfNotExists    3.0.0
Audit Linux machines that have accounts without passwords    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that have accounts without passwords    AuditIfNotExists, Disabled    1.0.0
Audit Linux machines that have the specified applications installed    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Chef InSpec resource indicates that one or more of the packages provided by the parameter are installed.    auditIfNotExists    3.0.0
Audit Log Analytics agent deployment in virtual machine scale sets - VM Image (OS) unlisted    Reports virtual machine scale sets as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    auditIfNotExists    1.0.1
Audit Log Analytics workspace for VM - Report Mismatch    Reports VMs as non-compliant if they aren't logging to the Log Analytics workspace specified in the policy/initiative assignment.    audit    1.0.1
Audit virtual machines without disaster recovery configured    Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.    auditIfNotExists    1.0.0
Audit VMs that do not use managed disks    This policy audits VMs that do not use managed disks    audit    1.0.0
Audit Windows machines missing any of specified members in the Administrators group    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the local Administrators group does not contain one or more members that are listed in the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines network connectivity    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if a network connection status to an IP and TCP port does not match the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines on which the DSC configuration is not compliant    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Windows PowerShell command Get-DSCConfigurationStatus returns that the DSC configuration for the machine is not compliant.    auditIfNotExists    1.0.0
Audit Windows machines on which the Log Analytics agent is not connected as expected    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the agent is not installed, or if it is installed but the COM object AgentConfigManager.MgmtSvcCfg returns that it is registered to a workspace other than the ID specified in the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines on which the specified services are not installed and 'Running'    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if result of the Windows PowerShell command Get-Service do not include the service name with matching status as specified by the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines on which Windows Serial Console is not enabled    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine does not have the Serial Console software installed or if the EMS port number or baud rate are not configured with the same values as the policy parameters.    auditIfNotExists    1.0.0
Audit Windows machines that allow re-use of the previous 24 passwords    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that allow re-use of the previous 24 passwords    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that are not joined to the specified domain    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the value of the Domain property in WMI class win32_computersystem does not match the value in the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines that are not set to the specified time zone    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the value of the property StandardName in WMI class Win32_TimeZone does not match the selected time zone for the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines that contain certificates expiring within the specified number of days    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if certificates in the specified store have an expiration date out of range for the number of days given as parameter. The policy also provides the option to only check for specific certificates or exclude specific certificates, and whether to report on expired certificates.    auditIfNotExists    1.0.0
Audit Windows machines that do not contain the specified certificates in Trusted Root    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine Trusted Root certificate store (Cert:\LocalMachine\Root) does not contain one or more of the certificates listed by the policy parameter.    auditIfNotExists    1.0.1
Audit Windows machines that do not have a maximum password age of 70 days    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a maximum password age of 70 days    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not have a minimum password age of 1 day    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a minimum password age of 1 day    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not have the password complexity setting enabled    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have the password complexity setting enabled    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not have the specified Windows PowerShell execution policy    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Windows PowerShell command Get-ExecutionPolicy returns a value other than what was selected in the policy parameter.    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not have the specified Windows PowerShell modules installed    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if a module isn't available in a location specified by the environment variable PSModulePath.    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not restrict the minimum password length to 14 characters    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not restrict the minimum password length to 14 characters    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that do not store passwords using reversible encryption    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not store passwords using reversible encryption    AuditIfNotExists, Disabled    1.0.0
Audit Windows machines that don't have the specified applications installed    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the application name is not found in any of the following registry paths: HKLM:SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, HKLM:SOFTWARE\Wow6432node\Microsoft\Windows\CurrentVersion\Uninstall, HKCU:Software\Microsoft\Windows\CurrentVersion\Uninstall.    auditIfNotExists    1.0.0
Audit Windows machines that have extra accounts in the Administrators group    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the local Administrators group contains members that are not listed in the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines that have not restarted within the specified number of days    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the WMI property LastBootUpTime in class Win32_Operatingsystem is outside the range of days provided by the policy parameter.    auditIfNotExists    1.0.0
Audit Windows machines that have the specified applications installed    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the application name is found in any of the following registry paths: HKLM:SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, HKLM:SOFTWARE\Wow6432node\Microsoft\Windows\CurrentVersion\Uninstall, HKCU:Software\Microsoft\Windows\CurrentVersion\Uninstall.    auditIfNotExists    1.0.0
Audit Windows machines that have the specified members in the Administrators group    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the local Administrators group contains one or more of the members listed in the policy parameter.    auditIfNotExists    1.0.0
Audit Windows VMs with a pending reboot    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine is pending reboot for any of the following reasons: component based servicing, Windows Update, pending file rename, pending computer rename, configuration manager pending reboot. Each detection has a unique registry path.    auditIfNotExists    1.0.0
Authentication to Linux machines should require SSH keys    Although SSH itself provides an encrypted connection, using passwords with SSH still leaves the VM vulnerable to brute-force attacks. The most secure option for authenticating to an Azure Linux virtual machine over SSH is with a public-private key pair, also known as SSH keys. Learn more: https://docs.microsoft.com/azure/virtual-machines/linux/create-ssh-keys-detailed.    AuditIfNotExists, Disabled    2.0.1
Azure Backup should be enabled for Virtual Machines    Ensure protection of your Azure Virtual Machines by enabling Azure Backup. Azure Backup is a secure and cost effective data protection solution for Azure.    AuditIfNotExists, Disabled    1.0.1
Configure backup on VMs with a given tag to a new recovery services vault with a default policy    Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally include virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupIncludeTag    deployIfNotExists    1.0.0-preview
Configure backup on VMs with a given tag to an existing recovery services vault in the same location    Enforce backup for all virtual machines by backing them up to an existing central recovery services vault in the same location and subscription as the virtual machine. Doing this is useful when there is a central team in your organization managing backups for all resources in a subscription. You can optionally include virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMCentralBackupIncludeTag    deployIfNotExists, auditIfNotExists, disabled    1.0.0-preview
Configure backup on VMs without a given tag to a new recovery services vault with a default policy    Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag    deployIfNotExists    1.0.0-preview
Configure backup on VMs without a given tag to an existing recovery services vault in the same location    Enforce backup for all virtual machines by backing them up to an existing central recovery services vault in the same location and subscription as the virtual machine. Doing this is useful when there is a central team in your organization managing backups for all resources in a subscription. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMCentralBackupExcludeTag    deployIfNotExists, auditIfNotExists, disabled    1.1.0
Configure time zone on Windows machines.    This policy creates a Guest Configuration assignment to set specified time zone on Windows virtual machines.    deployIfNotExists    1.1.0
Deploy - Configure disaster recovery on virtual machines by enabling replication    Virtual machines without disaster recovery configurations are vulnerable to outages and other disruptions. If the virtual machine does not already have disaster recovery configured, this would initiate the same by enabling replication using preset configurations to facilitate business continuity. To learn more about disaster recovery, visit https://aka.ms/asr-doc.    deployIfNotExists    1.0.0
Deploy - Configure Linux Azure Monitor agent to enable Azure Monitor assignments on Linux virtual machines    Configure Linux Azure Monitor agent to Linux virtual machines hosted in Azure that are supported by Azure Monitor. Azure Monitor agent collects events from the virtual machine that can be used to provide recommendations. Target virtual machines must be in a supported location.    deployIfNotExists    1.0.0-preview
Deploy - Configure Linux machines to automatically install the Azure Security agent    Configure Linux machines to automatically install the Azure Security agent. Security Center collects events from the agent and uses them to provide security alerts and tailored hardening tasks (recommendations). Create a resource group and Log Analytics workspace in the same region as the machine to store audit records. Target virtual machines must be in a supported location.    deployIfNotExists    1.0.0-preview
Deploy - Configure Windows Azure Monitor agent to enable Azure Monitor assignments on Windows virtual machines    Configure Windows Azure Monitor agent to Windows virtual machines hosted in Azure that are supported by Azure Monitor. Azure Monitor agent collects events from the virtual machine that can be used to provide recommendations. Target virtual machines must be in a supported location.    deployIfNotExists    1.0.0-preview
Deploy - Configure Windows machines to automatically install the Azure Security agent    Configure Windows machines to automatically install the Azure Security agent. Security Center collects events from the agent and uses them to provide security alerts and tailored hardening tasks (recommendations). Create a resource group and Log Analytics workspace in the same region as the machine to store audit records. Target virtual machines must be in a supported location.    deployIfNotExists    1.0.0-preview
Deploy default Microsoft IaaSAntimalware extension for Windows Server    This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.    deployIfNotExists    1.0.0
Deploy Dependency agent for Linux virtual machine scale sets    Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.    deployIfNotExists    1.3.0
Deploy Dependency agent for Linux virtual machines    Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.    deployIfNotExists    1.3.0
Deploy Dependency agent for Windows virtual machine scale sets    Deploy Dependency agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.    deployIfNotExists    1.3.0
Deploy Dependency agent for Windows virtual machines    Deploy Dependency agent for Windows virtual machines if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    deployIfNotExists    1.3.0
Deploy Log Analytics agent for Linux virtual machine scale sets    Deploy Log Analytics agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.    deployIfNotExists    2.0.0
Deploy Log Analytics agent for Linux VMs    Deploy Log Analytics agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.    deployIfNotExists    2.0.0
Deploy Log Analytics agent for Windows virtual machine scale sets    Deploy Log Analytics agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.    deployIfNotExists    1.1.0
Deploy Log Analytics agent for Windows VMs    Deploy Log Analytics agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.    deployIfNotExists    1.1.0
Deploy the Linux Guest Configuration extension to enable Guest Configuration assignments on Linux VMs    This policy deploys the Linux Guest Configuration extension to Linux virtual machines hosted in Azure that are supported by Guest Configuration. The Linux Guest Configuration extension is a prerequisite for all Linux Guest Configuration assignments and must deployed to machines before using any Linux Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.    deployIfNotExists    1.0.0
Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs    This policy deploys the Windows Guest Configuration extension to Windows virtual machines hosted in Azure that are supported by Guest Configuration. The Windows Guest Configuration extension is a prerequisite for all Windows Guest Configuration assignments and must deployed to machines before using any Windows Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.    deployIfNotExists    1.0.0
Disk encryption should be applied on virtual machines    Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.    AuditIfNotExists, Disabled    2.0.0
Enable Automanage - Azure virtual machine best practices    Automanage enrolls, configures, and monitors virtual machines with Azure VM best practice services. Use this policy to apply Automanage to your selected scope.    deployIfNotExists    1.0.0
Endpoint protection solution should be installed on virtual machine scale sets    Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.    AuditIfNotExists, Disabled    3.0.0
Guest Configuration extension should be installed on your machines    To ensure secure configurations of in-guest settings of your machine, install the Guest Configuration extension. In-guest settings that the extension monitors include the configuration of the operating system, application configuration or presence, and environment settings. Once installed, in-guest policies will be available such as 'Windows Exploit guard should be enabled'. Learn more at https://aka.ms/gcpol.    AuditIfNotExists, Disabled    1.0.1
Internet-facing virtual machines should be protected with network security groups    Protect your virtual machines from potential threats by restricting access to them with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc    AuditIfNotExists, Disabled    3.0.0
IP Forwarding on your virtual machine should be disabled    Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.    AuditIfNotExists, Disabled    3.0.0
Linux machines should meet requirements for the Azure security baseline    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines should meet the requirements for the Azure security baseline    AuditIfNotExists, Disabled    1.1.0-preview
Log Analytics agent health issues should be resolved on your machines    Security Center uses the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA). To make sure your virtual machines are successfully monitored, you need to make sure the agent is installed on the virtual machines and properly collects security events to the configured workspace.    AuditIfNotExists, Disabled    1.0.0
Log Analytics agent should be installed on your virtual machine for Azure Security Center monitoring    This policy audits any Windows/Linux virtual machines (VMs) if the Log Analytics agent is not installed which Security Center uses to monitor for security vulnerabilities and threats    AuditIfNotExists, Disabled    1.0.0
Log Analytics agent should be installed on your virtual machine scale sets for Azure Security Center monitoring    Security Center collects data from your Azure virtual machines (VMs) to monitor for security vulnerabilities and threats.    AuditIfNotExists, Disabled    1.0.0
Management ports of virtual machines should be protected with just-in-time network access control    Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
Management ports should be closed on your virtual machines    Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.    AuditIfNotExists, Disabled    3.0.0
Microsoft Antimalware for Azure should be configured to automatically update protection signatures    This policy audits any Windows virtual machine not configured with automatic update of Microsoft Antimalware protection signatures.    AuditIfNotExists, Disabled    1.0.0
Microsoft IaaSAntimalware extension should be deployed on Windows servers    This policy audits any Windows server VM without Microsoft IaaSAntimalware extension deployed.    AuditIfNotExists, Disabled    1.0.0
Monitor missing Endpoint Protection in Azure Security Center    Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
Network traffic data collection agent should be installed on Linux virtual machines    Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.    AuditIfNotExists, Disabled    1.0.1-preview
Network traffic data collection agent should be installed on Windows virtual machines    Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.    AuditIfNotExists, Disabled    1.0.1-preview
Non-internet-facing virtual machines should be protected with network security groups    Protect your non-internet-facing virtual machines from potential threats by restricting access with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc    AuditIfNotExists, Disabled    3.0.0
Only approved VM extensions should be installed    This policy governs the virtual machine extensions that are not approved.    Audit, Deny, Disabled    1.0.0
Require automatic OS image patching on Virtual Machine Scale Sets    This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.    deny    1.0.0
Resource logs in Virtual Machine Scale Sets should be enabled    It is recommended to enable Logs so that activity trail can be recreated when investigations are required in the event of an incident or a compromise.    AuditIfNotExists, Disabled    2.0.1
System updates on virtual machine scale sets should be installed    Audit whether there are any missing system security updates and critical updates that should be installed to ensure that your Windows and Linux virtual machine scale sets are secure.    AuditIfNotExists, Disabled    3.0.0
System updates should be installed on your machines    Missing security system updates on your servers will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
The Log Analytics agent should be installed on Virtual Machine Scale Sets    This policy audits any Windows/Linux Virtual Machine Scale Sets if the Log Analytics agent is not installed.    AuditIfNotExists, Disabled    1.0.0
The Log Analytics agent should be installed on virtual machines    This policy audits any Windows/Linux virtual machines if the Log Analytics agent is not installed.    AuditIfNotExists, Disabled    1.0.0
Unattached disks should be encrypted    This policy audits any unattached disk without encryption enabled.    Audit, Disabled    1.0.0
Virtual machines should be migrated to new Azure Resource Manager resources    Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management    Audit, Deny, Disabled    1.0.0
Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity    The Guest Configuration extension requires a system assigned managed identity. Azure virtual machines in the scope of this policy will be non-compliant when they have the Guest Configuration extension installed but do not have a system assigned managed identity. Learn more at https://aka.ms/gcpol    AuditIfNotExists, Disabled    1.0.1
Vulnerabilities in container security configurations should be remediated    Audit vulnerabilities in security configuration on machines with Docker installed and display as recommendations in Azure Security Center.    AuditIfNotExists, Disabled    3.0.0
Vulnerabilities in security configuration on your machines should be remediated    Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
Vulnerabilities in security configuration on your virtual machine scale sets should be remediated    Audit the OS vulnerabilities on your virtual machine scale sets to protect them from attacks.    AuditIfNotExists, Disabled    3.0.0
Vulnerabilities on your SQL servers on machine should be remediated    SQL Vulnerability Assessment scans your database for security vulnerabilities, and exposes any deviations from best practices such as misconfigurations, excessive permissions, and unprotected sensitive data. Resolving the vulnerabilities found can greatly improve your database security posture.    AuditIfNotExists, Disabled    1.0.0
Windows Defender Exploit Guard should be enabled on your machines    Windows Defender Exploit Guard uses the Azure Policy Guest Configuration agent. Exploit Guard has four components that are designed to lock down devices against a wide variety of attack vectors and block behaviors commonly used in malware attacks while enabling enterprises to balance their security risk and productivity requirements (Windows only).    AuditIfNotExists, Disabled    1.1.1
Windows machines should meet requirements for 'Administrative Templates - Control Panel'    Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - Control Panel' for input personalization and prevention of enabling lock screens. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Administrative Templates - MSS (Legacy)'    Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - MSS (Legacy)' for automatic logon, screen saver, network behavior, safe DLL, and event log. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Administrative Templates - Network'    Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - Network' for guest logons, simultaneous connections, network bridge, ICS, and multicast name resolution. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Administrative Templates - System'    Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - System' for settings that control the administrative experience and Remote Assistance. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Accounts'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Accounts' for limiting local account use of blank passwords and guest account status. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Audit'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Audit' for forcing audit policy subcategory and shutting down if unable to log security audits. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Devices'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Devices' for undocking without logging on, installing print drivers, and formatting/ejecting media. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Interactive Logon'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Interactive Logon' for displaying last user name and requiring ctrl-alt-del. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Microsoft Network Client'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Microsoft Network Client' for Microsoft network client/server and SMB v1. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Microsoft Network Server'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Microsoft Network Server' for disabling SMB v1 server. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Network Access'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Access' for including access for anonymous users, local accounts, and remote access to the registry. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Network Security'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Security' for including Local System behavior, PKU2U, LAN Manager, LDAP client, and NTLM SSP. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Recovery console'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Recovery console' for allowing floppy copy and access to all drives and folders. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - Shutdown'    Windows machines should have the specified Group Policy settings in the category 'Security Options - Shutdown' for allowing shutdown without logon and clearing the virtual memory pagefile. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - System objects'    Windows machines should have the specified Group Policy settings in the category 'Security Options - System objects' for case insensitivity for non-Windows subsystems and permissions of internal system objects. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - System settings'    Windows machines should have the specified Group Policy settings in the category 'Security Options - System settings' for certificate rules on executables for SRP and optional subsystems. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Options - User Account Control'    Windows machines should have the specified Group Policy settings in the category 'Security Options - User Account Control' for mode for admins, behavior of elevation prompt, and virtualizing file and registry write failures. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Security Settings - Account Policies'    Windows machines should have the specified Group Policy settings in the category 'Security Settings - Account Policies' for password history, age, length, complexity, and storing passwords using reversible encryption. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Account Logon'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Account Logon' for auditing credential validation and other account logon events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Account Management'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Account Management' for auditing application, security, and user group management, and other management events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Detailed Tracking'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Detailed Tracking' for auditing DPAPI, process creation/termination, RPC events, and PNP activity. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Logon-Logoff'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Logon-Logoff' for auditing IPSec, network policy, claims, account lockout, group membership, and logon/logoff events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Object Access'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Object Access' for auditing file, registry, SAM, storage, filtering, kernel, and other system types. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Policy Change'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Policy Change' for auditing changes to system audit policies. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - Privilege Use'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Privilege Use' for auditing nonsensitive and other privilege use. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'System Audit Policies - System'    Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - System' for auditing IPsec driver, system integrity, system extension, state change, and other system events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'User Rights Assignment'    Windows machines should have the specified Group Policy settings in the category 'User Rights Assignment' for allowing log on locally, RDP, access from the network, and many other user activities. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Windows Components'    Windows machines should have the specified Group Policy settings in the category 'Windows Components' for basic authentication, unencrypted traffic, Microsoft accounts, telemetry, Cortana, and other Windows behaviors. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements for 'Windows Firewall Properties'    Windows machines should have the specified Group Policy settings in the category 'Windows Firewall Properties' for firewall state, connections, rule management, and notifications. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.    AuditIfNotExists, Disabled    2.0.0
Windows machines should meet requirements of the Azure Security Center baseline    Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine is not configured correctly for one of the recommendations in the Azure Security Center baseline.    AuditIfNotExists, Disabled    1.0.0-preview
Windows web servers should be configured to use secure communication protocols    To protect the privacy of information communicated over the Internet, your web servers should use the latest version of the industry-standard cryptographic protocol, Transport Layer Security (TLS). TLS secures communications over a network by using security certificates to encrypt a connection between machines. TLS 1.3 is faster and more secure than the earlier versions: TLS 1.0-1.2 and SSL 2-3, which are all considered legacy protocols.    AuditIfNotExists, Disabled    2.0.0
Microsoft.ClassicCompute
MICROSOFT.CLASSICCOMPUTE
Name
(Azure portal)    Description    Effect(s)    Version
(GitHub)
A vulnerability assessment solution should be enabled on your virtual machines    Audits virtual machines to detect whether they are running a supported vulnerability assessment solution. A core component of every cyber risk and security program is the identification and analysis of vulnerabilities. Azure Security Center's standard pricing tier includes vulnerability scanning for your virtual machines at no extra cost. Additionally, Security Center can automatically deploy this tool for you.    AuditIfNotExists, Disabled    3.0.0
Adaptive application controls for defining safe applications should be enabled on your machines    Enable application controls to define the list of known-safe applications running on your machines, and alert you when other applications run. This helps harden your machines against malware. To simplify the process of configuring and maintaining your rules, Security Center uses machine learning to analyze the applications running on each machine and suggest the list of known-safe applications.    AuditIfNotExists, Disabled    3.0.0
All network ports should be restricted on network security groups associated to your virtual machine    Azure Security Center has identified some of your network security groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to target your resources.    AuditIfNotExists, Disabled    3.0.0
Allowlist rules in your adaptive application control policy should be updated    Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center's adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to allow in adaptive application control policies.    AuditIfNotExists, Disabled    3.0.0
Audit virtual machines without disaster recovery configured    Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.    auditIfNotExists    1.0.0
Disk encryption should be applied on virtual machines    Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.    AuditIfNotExists, Disabled    2.0.0
Internet-facing virtual machines should be protected with network security groups    Protect your virtual machines from potential threats by restricting access to them with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc    AuditIfNotExists, Disabled    3.0.0
IP Forwarding on your virtual machine should be disabled    Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.    AuditIfNotExists, Disabled    3.0.0
Log Analytics agent health issues should be resolved on your machines    Security Center uses the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA). To make sure your virtual machines are successfully monitored, you need to make sure the agent is installed on the virtual machines and properly collects security events to the configured workspace.    AuditIfNotExists, Disabled    1.0.0
Log Analytics agent should be installed on your virtual machine for Azure Security Center monitoring    This policy audits any Windows/Linux virtual machines (VMs) if the Log Analytics agent is not installed which Security Center uses to monitor for security vulnerabilities and threats    AuditIfNotExists, Disabled    1.0.0
Management ports should be closed on your virtual machines    Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.    AuditIfNotExists, Disabled    3.0.0
Monitor missing Endpoint Protection in Azure Security Center    Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
Non-internet-facing virtual machines should be protected with network security groups    Protect your non-internet-facing virtual machines from potential threats by restricting access with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc    AuditIfNotExists, Disabled    3.0.0
Operating system version should be the most current version for your cloud service roles    Keeping the operating system (OS) on the most recent supported version for your cloud service roles enhances the systems security posture.    AuditIfNotExists, Disabled    1.0.0
System updates should be installed on your machines    Missing security system updates on your servers will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
Virtual machines should be migrated to new Azure Resource Manager resources    Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management    Audit, Deny, Disabled    1.0.0
Vulnerabilities in container security configurations should be remediated    Audit vulnerabilities in security configuration on machines with Docker installed and display as recommendations in Azure Security Center.    AuditIfNotExists, Disabled    3.0.0
Vulnerabilities in security configuration on your machines should be remediated    Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations    AuditIfNotExists, Disabled    3.0.0
